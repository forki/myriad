@{
    ViewBag.Title = "Home Page";
}

@{
    var client = new WebClient();
    var json = client.DownloadString("http://localhost:8083/dimensions");
    var dimensions = Json.Decode(json);
}

<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <title></title>

    <script src="@Href("~/Scripts/jquery-1.10.2.min.js")" type="text/javascript"></script>
    <script src="@Href("~/Scripts/jquery-ui-1.11.4/jquery-ui.min.js")" type="text/javascript"></script>
    <link href="@Href("~/Scripts/jquery-ui-1.11.4/jquery-ui.theme.min.css")" type="text/css" rel="stylesheet"/>
    <link href="@Href("~/Scripts/jquery-ui-1.11.4/jquery-ui.css")" type="text/css" rel="stylesheet"/>

    <script type="text/javascript">
        $(function() {
            @foreach (var result in dimensions)
            {
                var addButton = "#btnAdd" + result.Dimension.Name;
                var clearButton = "#btnClear" + result.Dimension.Name;
                @:$('@addButton').button({ icons: { primary: "ui-icon-plusthick" }, text: false });
                @:$('@clearButton').button({ icons: { primary: "ui-icon-closethick" }, text: false });

                var selectList = "#list" + result.Dimension.Name;
                @:$('@selectList ul').append(
                @:    $('<li>').append(
                @:      $('<a>').attr('href', '/user/messages').append(
                @:          $('<span>').attr('class', 'tab').append("Message center")
                @:)));

                @:var values = [];
                foreach (var value in result.Values)
                {
                    @:values.push('@value');
                }
                @:values.sort();
                @:$('#@result.Dimension.Name').autocomplete({ source: values, minLength: 0 });                
            }
        });
    </script>    
</head>
<body>

    @foreach (var result in dimensions)
    {
        var addButton = "btnAdd" + result.Dimension.Name;
        var clearButton = "btnClear" + result.Dimension.Name;
        var selectList = "list" + result.Dimension.Name;
        <form method="post">            
            <label for="@result.Dimension.Name">@result.Dimension.Name</label>
            <button id="@addButton">Add</button>
            <button id="@clearButton">Clear</button> 
            <p>
            <input type="text" id="@result.Dimension.Name" onfocus="javascript:$(this).autocomplete('search','');" />
            <div id="selectList">
                <ul></ul>
            </div>
        </form>
    }

</body>
</html>
